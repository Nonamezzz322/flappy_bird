{"version":3,"sources":["index.js"],"names":["cvs","document","getElementById","ctx","getContext","pauseBtn","startBtn","reloadBtn","canvasGame","gameBlock","menuBlock","playNow","menuPlay","menuSkins","skinsBlock","menuLeaders","menuLeadersTable","menuExit","nameChange","acceptNameChange","menuEnterGame","menuAccept","menuBack","nickname","afterGame","scoreAfterDiv","highscoreDiv","tableData","backToMenu","leaveGame","setSkin1","setSkin2","setSkin3","setSkin4","bird","Image","bg","fg","pipeUp","pipeBottom","fly","Audio","score_audio","failSound","src","pipe","x","width","y","pause","gap","score","bestScore","xPos","yPos","grav","leadArr","birdLive","moveUp","e","type","preventDefault","keyCode","currentTime","play","moveUpBird","setInterval","setTimeout","clearInterval","draw","drawImage","i","length","height","push","Math","floor","random","requestAnimationFrame","gameOver","setScoreObj","setBestScore","getBestScore","fillStyle","font","fillText","animations","sleep","cancelAnimationFrame","style","display","removeEventListener","start","addEventListener","skinChange","checkLocalStorage","innerText","reload","pushNick","localStorage","setItem","value","scoreObj","getItem","Promise","res","rej","then","JSON","stringify","storage","leadTablePush","sortArray","parse","console","log","splice","sort","a","b","leadTableArr","reverse","leadTableNew","createTable","rows","cells","name","openMenu","exitMenu","playMenu","enterGame","skinsMenu","backMenu","leadersMenu","acceptName","acceptChangeName","changeName","storageSkinKey","background","className","onkeydown","charCode"],"mappings":"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","file":"flappy_bird.8fd28ae4.map","sourceRoot":"..","sourcesContent":["const cvs = document.getElementById(\"game\");\r\nconst ctx = cvs.getContext(\"2d\");\r\nconst pauseBtn = document.getElementById('pause');\r\nconst startBtn = document.getElementById('start');\r\nconst reloadBtn = document.getElementById('reload');\r\nconst canvasGame = document.getElementById(\"canvas_game\");\r\nconst gameBlock = document.getElementById(\"game_block\");\r\nconst menuBlock = document.getElementById(\"menu_block\");\r\nconst playNow = document.getElementById(\"play_now\");\r\nconst menuPlay = document.getElementById(\"menu_play\");\r\nconst menuSkins = document.getElementById(\"menu_skins\");\r\nconst skinsBlock = document.getElementById(\"skins\");\r\nconst menuLeaders = document.getElementById(\"menu_leaders\");\r\nconst menuLeadersTable = document.getElementById(\"menu_leaders_table\");\r\nconst menuExit = document.getElementById(\"menu_exit\");\r\nconst nameChange = document.getElementById(\"name_change\");\r\nconst acceptNameChange = document.getElementById(\"accept_name_change\");\r\nconst menuEnterGame = document.getElementById(\"menu_enter_name\");\r\nconst menuAccept = document.getElementById(\"menu_accept\");\r\nconst menuBack = document.getElementById(\"back_menu\");\r\nconst nickname = document.getElementById('name');\r\nconst afterGame = document.getElementById(\"after_game\");\r\nconst scoreAfterDiv = document.getElementById(\"score_after\");\r\nconst highscoreDiv = document.getElementById(\"highscore\");\r\nconst tableData = document.getElementById(\"table_data\");\r\nconst backToMenu = document.getElementById(\"back_to_menu\");\r\nconst leaveGame = document.getElementById(\"leave\");\r\nconst setSkin1 = document.getElementById(\"skin_1\");\r\nconst setSkin2 = document.getElementById(\"skin_2\");\r\nconst setSkin3 = document.getElementById(\"skin_3\");\r\nconst setSkin4 = document.getElementById(\"skin_4\");\r\n\r\nlet bird = new Image();\r\nlet bg = new Image();\r\nlet fg = new Image();\r\nlet pipeUp = new Image();\r\nlet pipeBottom = new Image();\r\nlet fly = new Audio();\r\nlet score_audio = new Audio();\r\nlet failSound = new Audio();\r\n\r\nscore_audio.src = \"audio/score.mp3\";\r\nfailSound.src = \"audio/fail.mp3\";\r\n\r\nlet pipe = [];\r\npipe[0] = {\r\n\tx : cvs.width,\r\n\ty : 0\r\n}\r\n\r\nlet pause = '';\r\nlet gap = 90;\r\nlet score = 0;\r\nlet bestScore = 0; //нужна для вывода highScore\r\nlet xPos = 10;\r\nlet yPos = 150;\r\nlet grav = 1.5;\r\nlet leadArr = []; // массив лидерборда\r\nlet birdLive = true; //проверяет мертва ли птичка сейчас\r\n\r\ngetBestScore();\r\nskinChange();\r\n\r\nfunction moveUp(e) {\r\n\tif(e.type == \"touchmove\") {\r\n\t\te.preventDefault();\r\n\t}\r\n\tif ((e.keyCode === 32 || e.type == \"touchstart\") && yPos > 30) {\r\n\t\tfly.currentTime = 0;\r\n\t\tfly.play();\r\n\t\tif(e.keyCode === 32) {\r\n\t\t\tlet moveUpBird = setInterval(() => yPos -= grav + 2.5, 1) //плавная анимация птички\r\n\t\t\tsetTimeout(() => clearInterval(moveUpBird), 30)\t\r\n\t\t} else if (e.type == \"touchstart\") {\r\n\t\t\tyPos -= 30;\r\n\t\t}\t\r\n\t}\r\n}\r\n\r\nfunction draw() {\r\n\tctx.drawImage(bg, 0, 0);\r\n\r\n\tfor (let i = 0; i < pipe.length; i += 1) {\r\n\t\tctx.drawImage(pipeUp, pipe[i].x, pipe[i].y);\r\n\t\tctx.drawImage(pipeBottom, pipe[i].x, pipe[i].y + pipeUp.height + gap);\r\n\r\n\t\tpipe[i].x -= 1;\r\n\r\n\t\tif (pipe[i].x == 115) {\r\n\t\t\tpipe.push({\r\n\t\t\t\tx : cvs.width,\r\n\t\t\t\ty : Math.floor(Math.random() * pipeUp.height) - pipeUp.height\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (xPos + bird.width >= pipe[i].x\r\n\t\t\t&& xPos <= pipe[i].x + pipeUp.width\r\n\t\t\t&& (yPos <= pipe[i].y + pipeUp.height\r\n\t\t\t|| yPos + bird.height >= pipe[i].y + pipeUp.height + gap) \r\n\t\t\t|| yPos + bird.height >= cvs.height - fg.height) {\r\n\r\n\t\t\t// failSound.play();\r\n\t\t\tbirdLive = false;\r\n\t\t\trequestAnimationFrame(gameOver);\r\n\t\t}\r\n\r\n\t\tif (pipe[i].x == 5) {\r\n\t\t\tscore += 1;\r\n\t\t\tsetScoreObj()\r\n\t\t\tsetBestScore()\r\n\t\t\tgetBestScore()\r\n\t\t\tscore_audio.play();\r\n\t\t}\r\n\t}\r\n\r\n\tctx.drawImage(fg, 0, cvs.height - fg.height);\r\n\tctx.drawImage(bird, xPos, yPos);\r\n\r\n\tyPos += grav;\r\n\r\n\tctx.fillStyle = \"#000\";\r\n\tctx.font = \"2.5rem Caveat\";\r\n\tctx.fillText(\"Score: \" + score, 10, cvs.height - 20);\r\n\t\r\n\tanimations = requestAnimationFrame(draw);\r\n}\r\n\r\ndocument.addEventListener(\"keydown\", moveUp);\r\ncanvasGame.addEventListener(\"touchstart\", moveUp);\r\ncanvasGame.addEventListener(\"touchmove\", moveUp);\r\npauseBtn.addEventListener(\"click\", sleep);\r\nstartBtn.addEventListener(\"click\", start);\r\nreloadBtn.addEventListener(\"click\", reload); //reload button\r\n\r\nfunction sleep() {\r\n\tcancelAnimationFrame(animations);\r\n\tstartBtn.style.display = \"block\";\r\n\tleaveGame.style.display = \"block\";\r\n\tpauseBtn.style.display = \"none\";\r\n\tdocument.removeEventListener(\"keydown\", moveUp);\r\n}\r\n\r\nfunction start() {\r\n\trequestAnimationFrame(draw);\r\n\tstartBtn.style.display = \"none\";\r\n\tleaveGame.style.display = \"none\";\r\n\tpauseBtn.style.display = \"block\";\r\n\tdocument.addEventListener(\"keydown\", moveUp);\r\n}\r\n\r\nfunction gameOver() {  //функция вызываемая после столкновения\r\n\tcancelAnimationFrame(animations);\r\n\tskinChange();\r\n\tif(score > 0){\r\n\t\tcheckLocalStorage();\r\n\t}\t\r\n\tcanvasGame.style.display = \"none\";\r\n\tstartBtn.style.display = \"none\";\r\n\tleaveGame.style.display = \"none\";\r\n\tpauseBtn.style.display = \"block\";\r\n\tafterGame.style.display = \"block\";\r\n\tscoreAfterDiv.innerText = `${score}`;\r\n\tif(score == bestScore) {\r\n\t\thighscoreDiv.innerText = `New best: \r\n\t\t${bestScore}`;\r\n\t} else if(score < bestScore) {\r\n\t\thighscoreDiv.innerText = `Best: \r\n\t\t${bestScore}`;\r\n\t} else if(bestScore === 0) {\r\n\t\thighscoreDiv.innerText = `New best: \r\n\t\t${score}`;\r\n\t}\r\n\r\n\tdocument.removeEventListener(\"keydown\", moveUp);\r\n}\r\n\r\nfunction reload() { //должна перезагружать страницу\r\n\tpipe = [];\r\n\tpipe[0] = {\r\n\t\tx : cvs.width,\r\n\t\ty : 0\r\n\t}\r\n\tscore = 0;\r\n\txPos = 10;\r\n\tyPos = 150;\r\n\r\n\tcanvasGame.style.display = \"block\";\r\n\tafterGame.style.display = \"none\";\r\n\tpauseBtn.style.display = \"block\";\r\n\tstartBtn.style.display = \"none\";\r\n\trequestAnimationFrame(draw);\r\n\tdocument.addEventListener(\"keydown\", moveUp);\r\n}\r\n\r\nfunction pushNick() { //добавляет ник в LocalStorage \r\n\tlocalStorage.setItem('name', nickname.value);\r\n\tnickname.value = \"\";\r\n}\r\n\r\nfunction setScoreObj() { //обновляет объект в LocalStorage при изменении счета \r\n\tlet scoreObj = {'name': localStorage.getItem('name', nickname.value), 'score': score};\r\n\tlet promise = new Promise(function(res,rej){\r\n\t\tres(scoreObj)\r\n\t}) \r\n\t\t.then(res => JSON.stringify(res))\r\n\t\t.then(res => localStorage.setItem('scoreObj', res));\r\n}\r\n\r\nfunction setBestScore() { // добавляет highScore\r\n\tlet storage = localStorage.getItem(\"highScore\");\r\n\tif (storage) {\r\n\t\tif (score > storage) {\r\n\t\t\tlocalStorage.setItem(\"highScore\", score);\r\n\t\t}\r\n\t} else {\r\n\t\t\tlocalStorage.setItem(\"highScore\", 0);\r\n\t}\r\n}\t\r\n\r\nfunction getBestScore() { //выводит счетчик highScore\r\n\tlet storage = localStorage.getItem(\"highScore\");\r\n    if (storage) {\r\n      bestScore = storage;\r\n    } else {\r\n      bestScore = 0;\r\n    }\r\n}\r\n\r\nfunction leadTablePush() {  // если в LocalStorage есть ключ 'leadArr' - выполняет пуш\r\n\tsortArray(leadArr);\r\n\r\n\tleadArr = JSON.parse(localStorage.getItem('leadArr'));\r\n\tlet scoreObj = {'name': localStorage.getItem('name', nickname.value), 'score': score};\r\n\tif(score > 0 && leadArr.length <= 4){\r\n\t\tleadArr.push(scoreObj)\r\n\t\tlocalStorage.setItem('leadArr', JSON.stringify(leadArr))\r\n\t} else if (score > leadArr[4].score && leadArr.length > 4 ){\r\n\t\tleadArr.splice(4, 1, scoreObj)\r\n\t\tlocalStorage.setItem('leadArr', JSON.stringify(leadArr))\r\n\t} else {\r\n\t\treturn console.log('you are not worthy to get on the leaderboard')\r\n\t}\r\n\tsortArray();\r\n}\r\n\r\n\r\nfunction sortArray(leadArr) {  //сортировщик по значению\r\n\tleadArr = JSON.parse(localStorage.getItem('leadArr'));\r\n\tleadArr.sort((a,b) => (a.score > b.score) ? 1 : ((b.score > a.score) ? -1 : 0))\r\n\tlet leadTableArr = leadArr.reverse();\r\n\tlocalStorage.setItem('leadArr', JSON.stringify(leadTableArr))\r\n}\r\n\r\n\r\nfunction leadTableNew() { // если в LocalStorage нет ключа 'leadArr' - создает его с текущими данными\r\n\tlet scoreObj = {'name': localStorage.getItem('name', nickname.value), 'score': score};\r\n\tleadArr.push(scoreObj)\r\n\tlet promise = new Promise(function(res, rej) {\r\n\t\tres(leadArr)\r\n\t}) \r\n\t\t.then(res => JSON.stringify(res))\r\n\t\t.then(res => localStorage.setItem('leadArr', res))\r\n}\r\n\r\nfunction checkLocalStorage() { // проверяет LocalStorage на наличие нужного ключа.\r\n\tif (localStorage.getItem('leadArr') !== null) {\r\n\t\tleadTablePush();\r\n\t} else {\r\n\t\tleadTableNew();\r\n\t}\r\n}\r\n\r\n\r\nfunction createTable() {\r\n\tleadArr = JSON.parse(localStorage.getItem('leadArr'));\r\n\tif(leadArr) {\t\r\n\t\tfor (let i = 0; i < leadArr.length; i += 1) {\r\n\t\t\ttableData.rows[i+1].cells[0].innerText = leadArr[i].name;\r\n\t\t\ttableData.rows[i+1].cells[1].innerText = leadArr[i].score;\r\n\t\t}\r\n\t}\r\n}\r\n\r\ndocument.onkeydown = function(e) { // убирает скролл страницы при нажатии на пробел.\r\n\tlet keyCode = e.keyCode || e.charCode;\r\n\tif (keyCode == 32) \r\n\te.preventDefault();\r\n}\r\n\r\n// слушатели на кнопки\r\nfunction openMenu() {\r\n\tgameBlock.style.display = \"block\";\r\n}\r\n\r\nfunction exitMenu() {\r\n\tgameBlock.style.display = \"none\";\r\n}\r\n\r\nfunction playMenu() {\r\n\tskinChange();\r\n\tmenuPlay.style.display = \"none\";\r\n\tmenuSkins.style.display = \"none\";\r\n\tmenuLeaders.style.display = \"none\";\r\n\tmenuExit.style.display = \"none\";\r\n\tnameChange.style.display = \"none\";\r\n\tif(localStorage.getItem('name')){\r\n\t\tif(birdLive === true) {\r\n\t\t\trequestAnimationFrame(draw);\r\n\t\t}\r\n\t\tenterGame();\r\n\t} else {\r\n\t\tmenuEnterGame.style.display = \"block\";\r\n\t\tmenuAccept.style.display = \"block\";\r\n\t\tmenuBack.style.display = \"block\";\r\n\t}\r\n\tif(birdLive === false){\r\n\t\treload();\r\n\t}\r\n}\r\n\r\nfunction skinsMenu() {\r\n\tmenuPlay.style.display = \"none\";\r\n\tmenuSkins.style.display = \"none\";\r\n\tmenuLeaders.style.display = \"none\";\r\n\tmenuExit.style.display = \"none\";\r\n\tnameChange.style.display = \"none\";\r\n\tmenuBack.style.display = \"block\";\r\n\tskinsBlock.style.display = \"block\";\r\n}\r\n\r\nfunction backMenu() {\r\n\tmenuEnterGame.style.display = \"none\";\r\n\tmenuBack.style.display = \"none\";\r\n\tmenuLeadersTable.style.display = \"none\";\r\n\tcanvasGame.style.display = \"none\";\r\n\tafterGame.style.display = \"none\";\r\n\tmenuAccept.style.display = \"none\";\r\n\tacceptNameChange.style.display = \"none\";\r\n\tskinsBlock.style.display = \"none\";\r\n\tmenuBlock.style.display = \"block\";\r\n\tmenuPlay.style.display = \"block\";\r\n\tmenuSkins.style.display = \"block\";\r\n\tmenuLeaders.style.display = \"block\";\r\n\tmenuExit.style.display = \"block\";\r\n\tnameChange.style.display = \"block\";\r\n}\r\n\r\nfunction leadersMenu() {\r\n\tmenuPlay.style.display = \"none\";\r\n\tmenuSkins.style.display = \"none\";\r\n\tmenuLeaders.style.display = \"none\";\r\n\tmenuExit.style.display = \"none\";\r\n\tnameChange.style.display = \"none\";\r\n\tmenuBack.style.display = \"block\";\r\n\tmenuLeadersTable.style.display = \"block\";\r\n\tcreateTable();\r\n}\r\n\r\nfunction enterGame() {\r\n\tpipe = [];\r\n\tpipe[0] = {\r\n\t\tx : cvs.width,\r\n\t\ty : 0\r\n\t}\r\n\tscore = 0;\r\n\txPos = 10;\r\n\tyPos = 150;\r\n\r\n\tmenuBlock.style.display = \"none\";\r\n\tcanvasGame.style.display = \"block\";\r\n\tafterGame.style =  \"display: none\";\r\n}\r\n\r\nfunction acceptName() {\r\n\tif (nickname.value) {\r\n\t\tpushNick();\r\n\t\tenterGame();\r\n\t\trequestAnimationFrame(draw);\r\n\t}\r\n}\r\n\r\nfunction acceptChangeName() {\r\n\tif (nickname.value) {\r\n\t\tpushNick();\r\n\t\tbackMenu();\r\n\t}\r\n}\r\n\r\nfunction changeName() {\r\n\tmenuPlay.style.display = \"none\";\r\n\tmenuSkins.style.display = \"none\";\r\n\tmenuLeaders.style.display = \"none\";\r\n\tmenuExit.style.display = \"none\";\r\n\tnameChange.style.display = \"none\";\r\n\tmenuEnterGame.style.display = \"block\";\r\n\tacceptNameChange.style.display = \"block\";\r\n\tmenuBack.style.display = \"block\";\t\r\n}\r\n\r\nplayNow.addEventListener('click', openMenu);\r\nmenuPlay.addEventListener('click', playMenu);\r\nmenuSkins.addEventListener('click', skinsMenu);\r\nmenuLeaders.addEventListener('click', leadersMenu);\r\nmenuExit.addEventListener('click', exitMenu);\r\nmenuBack.addEventListener('click', backMenu);\r\nbackToMenu.addEventListener('click', backMenu);\r\nleaveGame.addEventListener('click', gameOver);\r\nmenuAccept.addEventListener('click', acceptName);\r\nnameChange.addEventListener('click', changeName);\r\nacceptNameChange.addEventListener('click', acceptChangeName);\r\n\r\n///////////////////////////////////////////// SKINS /////////////////////////////////////\r\n\r\nfunction skinChange() {\r\n\tconst storageSkinKey = JSON.parse(localStorage.getItem('skinKey'));\r\n\tif (storageSkinKey === 1 || !storageSkinKey) {\r\n\t\tbird.src = \"img/bird.png\";\r\n\t\tbg.src = \"img/bg.png\";\r\n\t\tfg.src = \"img/fg.png\";\r\n\t\tpipeUp.src = \"img/pipeUp.png\";\r\n\t\tpipeBottom.src = \"img/pipeBottom.png\";\r\n\t\tmenuBlock.style.background = \"url('./img/bg.png') no-repeat 50% 50% /cover\";\r\n\t\tafterGame.style.background = \"url('./img/bg.png') no-repeat 50% 50% /cover\";\r\n\t\tfly.src = \"audio/fly.mp3\";\r\n\t\tsetSkin1.className = \"active\";\r\n\t\tsetSkin2.className = \"\";\r\n\t\tsetSkin3.className = \"\";\r\n\t\tsetSkin4.className = \"\";\r\n\t} else if (storageSkinKey === 2) {\r\n\t\tbird.src = \"img/birdGray.png\";\r\n\t\tbg.src = \"img/bgGray.png\";\r\n\t\tfg.src = \"img/fgGray.png\";\r\n\t\tpipeUp.src = \"img/pipeUpGray.png\";\r\n\t\tpipeBottom.src = \"img/pipeBottomGray.png\";\r\n\t\tmenuBlock.style.background = \"url('./img/bgGray.png') no-repeat 50% 50% /cover\";\r\n\t\tafterGame.style.background = \"url('./img/bgGray.png') no-repeat 50% 50% /cover\";\r\n\t\tfly.src = \"audio/fly.mp3\";\r\n\t\tsetSkin1.className = \"\";\r\n\t\tsetSkin2.className = \"active\";\r\n\t\tsetSkin3.className = \"\";\r\n\t\tsetSkin4.className = \"\";\r\n\t} else if (storageSkinKey === 3) {\r\n\t\tbird.src = \"img/bird3.png\";\r\n\t\tbg.src = \"img/bg3.png\";\r\n\t\tfg.src = \"img/fg3.png\";\r\n\t\tpipeUp.src = \"img/pipeUpOrange.png\";\r\n\t\tpipeBottom.src = \"img/pipeBottomOrange.png\";\r\n\t\tmenuBlock.style.background = \"url('./img/bg3.png') no-repeat 50% 50% /cover\";\r\n\t\tafterGame.style.background = \"url('./img/bg3.png') no-repeat 50% 50% /cover\";\r\n\t\tfly.src = \"audio/fly.mp3\";\r\n\t\tsetSkin1.className = \"\";\r\n\t\tsetSkin2.className = \"\";\r\n\t\tsetSkin3.className = \"active\";\r\n\t\tsetSkin4.className = \"\";\r\n\t} else if (storageSkinKey === 4) {\r\n\t\tbird.src = \"img/birdCat.png\";\r\n\t\tbg.src = \"img/bgSpace.jpg\";\r\n\t\tfg.src = \"img/fgRainbow.png\";\r\n\t\tpipeUp.src = \"img/pipeUpPink.png\";\r\n\t\tpipeBottom.src = \"img/pipeBottomPink.png\";\r\n\t\tmenuBlock.style.background = \"url('./img/bgSpace.jpg') no-repeat 50% 50% /cover\";\r\n\t\tafterGame.style.background = \"url('./img/bgSpace.jpg') no-repeat 50% 50% /cover\";\r\n\t\tfly.src = \"audio/skin_4.mp3\";\r\n\t\tsetSkin1.className = \"\";\r\n\t\tsetSkin2.className = \"\";\r\n\t\tsetSkin3.className = \"\";\r\n\t\tsetSkin4.className = \"active\";\r\n\t}\t\r\n}\r\n\r\nsetSkin1.addEventListener(\"click\", () => {\r\n\tJSON.stringify(localStorage.setItem('skinKey', 1));\r\n\tskinChange();\r\n});\r\nsetSkin2.addEventListener(\"click\", () => {\r\n\tJSON.stringify(localStorage.setItem('skinKey', 2));\r\n\tskinChange();\r\n});\r\nsetSkin3.addEventListener(\"click\", () => {\r\n\tJSON.stringify(localStorage.setItem('skinKey', 3));\r\n\tskinChange();\r\n});\r\nsetSkin4.addEventListener(\"click\", () => {\r\n\tJSON.stringify(localStorage.setItem('skinKey', 4));\r\n\tskinChange();\r\n});"]}